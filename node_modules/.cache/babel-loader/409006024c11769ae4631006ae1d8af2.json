{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{PureComponent}from\"react\";import ComposeMessage from\"../../../compose-message/ComposeMessage\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faTrash,faReply,faArrowLeft}from\"@fortawesome/free-solid-svg-icons\";import{getNameEmail}from\"../../../../utils\";import moment from\"moment\";import\"./messageToolbar.scss\";export var MessageToolbar=/*#__PURE__*/function(_PureComponent){_inherits(MessageToolbar,_PureComponent);var _super=_createSuper(MessageToolbar);function MessageToolbar(props){var _this;_classCallCheck(this,MessageToolbar);_this=_super.call(this,props);_this.trashHandler=_this.getClickHandler([\"TRASH\"]);_this.prevBack=_this.getClickHandler([\"BACK\"]);return _this;}_createClass(MessageToolbar,[{key:\"getClickHandler\",value:function getClickHandler(action){var _this2=this;console.log(action,'action');return function(evt){_this2.props.onClick(action);};}},{key:\"render\",value:function render(){if(!this.props.messageResult.result){return null;}var message=this.props.messageResult.result;var messageHeaders=message.messageHeaders;var replyTo,cc,subject;for(var i=0;i<messageHeaders.length;i++){var header=messageHeaders[i];switch(header.name){case\"Subject\":subject=header;break;case\"From\":if(!replyTo){replyTo=header;}break;case\"Reply-To\":replyTo=header;break;case\"Cc\":cc=header;break;default:break;}}if(replyTo.value===''){replyTo=messageHeaders.find(function(e){return e.name===\"From\";});}var nameEmail=getNameEmail(replyTo.value);var receivedHeader=messageHeaders.find(function(el){return el.name===\"X-Received\";});var date=receivedHeader?receivedHeader.value.split(\";\")[1].trim():\"\";var parsedDate=moment(date);if(!parsedDate.isValid()){parsedDate=moment(parseInt(this.props.messageResult.result.internalDate));}var replyHeader=\"<p>On \".concat(parsedDate.format(\"MMMM Do YYYY, h:mm:ss a\"),\" < \").concat(nameEmail.email,\" > wrote:</p>\");var composeProps=_objectSpread({subject:\"Re: \".concat(subject.value),to:nameEmail.email,content:\"<p>&nbsp;</p>\\n          <p>&nbsp;</p>\\n          <p>&nbsp;</p>\\n          \".concat(replyHeader,\"\\n          <blockquote>\").concat(this.props.messageResult.body,\"</blockquote>\")},cc&&{cc:cc.value});return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-center align-items-center message-toolbar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"action-btns\"},/*#__PURE__*/React.createElement(\"div\",{className:\"action-btn mr-2\"},/*#__PURE__*/React.createElement(\"button\",{className:\"action-btn\",onClick:this.prevBack},/*#__PURE__*/React.createElement(FontAwesomeIcon,{title:\"back\",icon:faArrowLeft,size:\"lg\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"action-btn mr-2\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn\",onClick:this.trashHandler},/*#__PURE__*/React.createElement(FontAwesomeIcon,{title:\"Move to Trash\",icon:faTrash,size:\"lg\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"action-btn mr-2\"},/*#__PURE__*/React.createElement(ComposeMessage,composeProps,/*#__PURE__*/React.createElement(\"button\",{className:\"btn\"},/*#__PURE__*/React.createElement(FontAwesomeIcon,{title:\"Reply\",icon:faReply,size:\"lg\"}))))));}}]);return MessageToolbar;}(PureComponent);export default MessageToolbar;","map":{"version":3,"sources":["C:/Users/grigo/OneDrive/Рабочий стол/CRM/src/components/content/message-list/message-toolbar/MessageToolbar.jsx"],"names":["React","PureComponent","ComposeMessage","FontAwesomeIcon","faTrash","faReply","faArrowLeft","getNameEmail","moment","MessageToolbar","props","trashHandler","getClickHandler","prevBack","action","console","log","evt","onClick","messageResult","result","message","messageHeaders","replyTo","cc","subject","i","length","header","name","value","find","e","nameEmail","receivedHeader","el","date","split","trim","parsedDate","isValid","parseInt","internalDate","replyHeader","format","email","composeProps","to","content","body"],"mappings":"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","sourcesContent":["import React, { PureComponent } from \"react\";\r\nimport ComposeMessage from \"../../../compose-message/ComposeMessage\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faTrash, faReply,faArrowLeft } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { getNameEmail } from \"../../../../utils\";\r\nimport moment from \"moment\";\r\nimport \"./messageToolbar.scss\";\r\n\r\nexport class MessageToolbar extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.trashHandler = this.getClickHandler([\"TRASH\"]);\r\n    this.prevBack=this.getClickHandler([\"BACK\"])\r\n  }\r\n\r\n  getClickHandler(action) {\r\n    console.log(action,'action')\r\n    return evt => {\r\n      this.props.onClick(action);\r\n    };\r\n  }\r\n\r\n  render() {\r\n    if (!this.props.messageResult.result) {\r\n      return null;\r\n    }\r\n\r\n    const message = this.props.messageResult.result;\r\n    const { messageHeaders } = message;\r\n\r\n    let replyTo, cc, subject;\r\n\r\n    for (let i = 0; i < messageHeaders.length; i++) {\r\n      const header = messageHeaders[i];\r\n      switch (header.name) {\r\n        case \"Subject\":\r\n          subject = header;\r\n          break;\r\n        case \"From\":\r\n          if (!replyTo) {\r\n            replyTo = header;\r\n          }\r\n          break;\r\n        case \"Reply-To\":\r\n          replyTo = header;\r\n          break;\r\n        case \"Cc\":\r\n          cc = header;\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n\r\n    if (replyTo.value === '') {\r\n      replyTo = messageHeaders.find(e => e.name === \"From\");\r\n    }\r\n\r\n    const nameEmail = getNameEmail(replyTo.value);\r\n    const receivedHeader = messageHeaders.find(el => el.name === \"X-Received\");\r\n    const date = receivedHeader ? receivedHeader.value\r\n          .split(\";\")[1]\r\n          .trim() : \"\";\r\n\r\n    let parsedDate = moment(date);\r\n\r\n    if (!parsedDate.isValid()) {\r\n      parsedDate = moment(\r\n        parseInt(this.props.messageResult.result.internalDate)\r\n      );\r\n    }\r\n    const replyHeader = `<p>On ${parsedDate.format(\"MMMM Do YYYY, h:mm:ss a\")} < ${nameEmail.email} > wrote:</p>`;\r\n\r\n    const composeProps = {\r\n      subject: `Re: ${subject.value}`,\r\n      to: nameEmail.email,\r\n      content: `<p>&nbsp;</p>\r\n          <p>&nbsp;</p>\r\n          <p>&nbsp;</p>\r\n          ${replyHeader}\r\n          <blockquote>${this.props.messageResult.body}</blockquote>`,\r\n      ...(cc && { cc: cc.value })\r\n    };\r\n\r\n    return (\r\n      <div className=\"d-flex justify-content-center align-items-center message-toolbar\">\r\n        <div className=\"action-btns\">\r\n          <div className=\"action-btn mr-2\">\r\n            <button className=\"action-btn\" onClick={this.prevBack}>\r\n              <FontAwesomeIcon\r\n                  title=\"back\"\r\n                  icon={faArrowLeft}\r\n                  size=\"lg\"\r\n              /> \r\n            </button>\r\n          </div>\r\n          <div className=\"action-btn mr-2\">\r\n            <button className=\"btn\" onClick={this.trashHandler}>\r\n              <FontAwesomeIcon\r\n                title=\"Move to Trash\"\r\n                icon={faTrash}\r\n                size=\"lg\"\r\n              />\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"action-btn mr-2\">\r\n          <ComposeMessage {...composeProps}>\r\n              <button className=\"btn\">\r\n                <FontAwesomeIcon\r\n                  title=\"Reply\"\r\n                  icon={faReply}\r\n                  size=\"lg\"\r\n                />\r\n              </button>\r\n            </ComposeMessage>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MessageToolbar;\r\n"]},"metadata":{},"sourceType":"module"}