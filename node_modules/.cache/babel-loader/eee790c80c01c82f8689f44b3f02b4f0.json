{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{PureComponent}from\"react\";import{withRouter}from\"react-router-dom\";import moment,{max}from\"moment\";import MesssageCheckbox from\"./MessageCheckbox\";import NameSubjectFields from\"./NameSubjectFields\";import AttachmentDateFields from\"./AttachmentDateFields\";import{getNameEmail}from'../../../../utils';export var MessageItem=/*#__PURE__*/function(_PureComponent){_inherits(MessageItem,_PureComponent);var _super=_createSuper(MessageItem);function MessageItem(props){var _this;_classCallCheck(this,MessageItem);_this=_super.call(this,props);_this.onSelectionChange=_this.onSelectionChange.bind(_assertThisInitialized(_this));_this.getMessage=_this.getMessage.bind(_assertThisInitialized(_this));return _this;}_createClass(MessageItem,[{key:\"onSelectionChange\",value:function onSelectionChange(evt){this.props.onSelectionChange(evt.target.checked,this.props.data.id);}},{key:\"getMessage\",value:function getMessage(evt){this.props.history.push(\"/\".concat(this.props.data.id));// window.location.reload(); \n}},{key:\"getFromName\",value:function getFromName(from){var nameEmail=getNameEmail(from);return nameEmail.name;}},{key:\"getFormattedDate\",value:function getFormattedDate(date,fallbackDateObj){var messageDate=moment(date);if(!messageDate.isValid()){messageDate=moment(fallbackDateObj.parserFn(fallbackDateObj.date));}var nowDate=moment(new Date());var isMessageFromToday=messageDate.format(\"YYYYMMDD\")===nowDate.format(\"YYYYMMDD\");var formattedDate;if(isMessageFromToday){formattedDate=messageDate.format(\"h:mm A\");}else{if(messageDate.year()!==nowDate.year()){formattedDate=messageDate.format(\"YYYY/MM/DD\");}else{formattedDate=messageDate.format(\"MMM D\");}}return formattedDate;}},{key:\"render\",value:function render(){var receivedHeader=this.props.data.payload.headers.find(function(el){return el.name.toUpperCase()===\"X-RECEIVED\";});var date=receivedHeader?receivedHeader.value.split(\";\")[1].trim():\"\";var formattedDate=this.getFormattedDate(date,{date:this.props.data.internalDate,parserFn:parseInt});var unread=this.props.data.labelIds.indexOf(\"UNREAD\")>-1?\" font-weight-bold\":\"\";var selected=this.props.data.selected?\" selected\":\"\";var subjectHeader=this.props.data.payload.headers.find(function(el){return el.name.toUpperCase()===\"SUBJECT\";});var subject=subjectHeader?subjectHeader.value:\"\";var fromHeader=this.props.data.payload.headers.find(function(el){return el.name.toUpperCase()===\"FROM\";});var fromName=fromHeader?this.getFromName(fromHeader.value):\"undefined\";var style={width:\"max-content\",textAlign:'left'};return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex table-row-wrapper\".concat(selected),style:style},/*#__PURE__*/React.createElement(MesssageCheckbox,{selected:this.props.data.selected,onChange:this.onSelectionChange}),/*#__PURE__*/React.createElement(\"div\",{onClick:this.getMessage,className:\"table-row px-2 py-3\".concat(unread)},/*#__PURE__*/React.createElement(NameSubjectFields,{fromName:fromName,subject:subject}),/*#__PURE__*/React.createElement(AttachmentDateFields,{formattedDate:formattedDate,hasAttachment:this.props.data.payload.mimeType===\"multipart/mixed\"})));}}]);return MessageItem;}(PureComponent);export default withRouter(MessageItem);","map":{"version":3,"sources":["C:/Users/grigo/OneDrive/Рабочий стол/CRM/src/components/content/message-list/message-row/MessageRow.jsx"],"names":["React","PureComponent","withRouter","moment","max","MesssageCheckbox","NameSubjectFields","AttachmentDateFields","getNameEmail","MessageItem","props","onSelectionChange","bind","getMessage","evt","target","checked","data","id","history","push","from","nameEmail","name","date","fallbackDateObj","messageDate","isValid","parserFn","nowDate","Date","isMessageFromToday","format","formattedDate","year","receivedHeader","payload","headers","find","el","toUpperCase","value","split","trim","getFormattedDate","internalDate","parseInt","unread","labelIds","indexOf","selected","subjectHeader","subject","fromHeader","fromName","getFromName","style","width","textAlign","mimeType"],"mappings":"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","sourcesContent":["import React, { PureComponent } from \"react\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport moment, { max } from \"moment\";\r\nimport MesssageCheckbox from \"./MessageCheckbox\";\r\n\r\nimport NameSubjectFields from \"./NameSubjectFields\";\r\nimport AttachmentDateFields from \"./AttachmentDateFields\";\r\nimport {getNameEmail} from '../../../../utils';\r\n\r\nexport class MessageItem extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.onSelectionChange = this.onSelectionChange.bind(this);\r\n    this.getMessage = this.getMessage.bind(this);\r\n  }\r\n\r\n  onSelectionChange(evt) {\r\n    this.props.onSelectionChange(evt.target.checked, this.props.data.id);\r\n  }\r\n\r\n  getMessage(evt) {\r\n    this.props.history.push(`/${this.props.data.id}`);\r\n    // window.location.reload(); \r\n  }\r\n\r\n  getFromName(from) {\r\n    const nameEmail = getNameEmail(from);\r\n    return nameEmail.name;\r\n  }\r\n\r\n  getFormattedDate(date, fallbackDateObj) {\r\n    let messageDate = moment(date);\r\n    if (!messageDate.isValid()) {\r\n      messageDate = moment(fallbackDateObj.parserFn(fallbackDateObj.date));\r\n    }\r\n    const nowDate = moment(new Date());\r\n    const isMessageFromToday = messageDate.format(\"YYYYMMDD\") === nowDate.format(\"YYYYMMDD\");\r\n    let formattedDate;\r\n    if (isMessageFromToday) {\r\n      formattedDate = messageDate.format(\"h:mm A\");\r\n    }\r\n    else {\r\n      if (messageDate.year() !== nowDate.year()) {\r\n        formattedDate = messageDate.format(\"YYYY/MM/DD\");\r\n      }\r\n      else {\r\n        formattedDate = messageDate.format(\"MMM D\");\r\n      }\r\n    }\r\n    return formattedDate;\r\n  }\r\n\r\n  render() {\r\n    const receivedHeader = this.props.data.payload.headers.find(el => el.name.toUpperCase() === \"X-RECEIVED\");\r\n    const date = receivedHeader ? receivedHeader.value.split(\";\")[1].trim() : \"\";\r\n    let formattedDate = this.getFormattedDate(date, {date: this.props.data.internalDate, parserFn: parseInt});\r\n    const unread = this.props.data.labelIds.indexOf(\"UNREAD\") > -1 ? \" font-weight-bold\" : \"\";\r\n    const selected = this.props.data.selected ? \" selected\" : \"\";\r\n    const subjectHeader = this.props.data.payload.headers.find(el => el.name.toUpperCase() === \"SUBJECT\");\r\n    const subject = subjectHeader ? subjectHeader.value : \"\";\r\n    const fromHeader = this.props.data.payload.headers.find(el => el.name.toUpperCase() === \"FROM\");\r\n    let fromName = fromHeader ? this.getFromName(fromHeader.value) : \"undefined\";\r\n    const style={width:\"max-content\",textAlign: 'left'}\r\n\r\n    return (\r\n      <div className={ `d-flex table-row-wrapper${selected}`} style={style}>\r\n        <MesssageCheckbox\r\n          selected={this.props.data.selected}\r\n          onChange={this.onSelectionChange}\r\n        />\r\n        <div\r\n          onClick={this.getMessage}\r\n          className={`table-row px-2 py-3${unread}`}\r\n        >\r\n          <NameSubjectFields fromName={fromName} subject={subject} />\r\n          <AttachmentDateFields\r\n            formattedDate={formattedDate}\r\n            hasAttachment={\r\n              this.props.data.payload.mimeType === \"multipart/mixed\"\r\n            }\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(MessageItem);\r\n"]},"metadata":{},"sourceType":"module"}