{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { append, prepend, createElement, extend, EventHandler, closest, addClass, isBlazor, getElement } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, setStyleAttribute, remove } from '@syncfusion/ej2-base';\nimport { EventBase } from './event-base';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar EVENT_GAP = 0;\n/**\n * Month view events render\n */\n\nvar MonthEvent =\n/** @class */\nfunction (_super) {\n  __extends(MonthEvent, _super);\n  /**\n   * Constructor for month events\n   */\n\n\n  function MonthEvent(parent) {\n    var _this = _super.call(this, parent) || this;\n\n    _this.renderedEvents = [];\n    _this.monthHeaderHeight = 0;\n    _this.moreIndicatorHeight = 19;\n    _this.renderType = 'day';\n    _this.element = _this.parent.activeView.getPanel();\n    _this.fields = _this.parent.eventFields;\n\n    _this.addEventListener();\n\n    return _this;\n  }\n\n  MonthEvent.prototype.renderAppointments = function () {\n    var conWrap = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n    if (this.parent.rowAutoHeight) {\n      this.parent.uiStateValues.top = conWrap.scrollTop;\n      this.parent.uiStateValues.left = conWrap.scrollLeft;\n    }\n\n    var appointmentWrapper = [].slice.call(this.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\n\n    for (var _i = 0, appointmentWrapper_1 = appointmentWrapper; _i < appointmentWrapper_1.length; _i++) {\n      var wrap = appointmentWrapper_1[_i];\n      remove(wrap);\n    }\n\n    this.removeHeightProperty(cls.CONTENT_TABLE_CLASS);\n\n    if (!this.element.querySelector('.' + cls.WORK_CELLS_CLASS)) {\n      return;\n    }\n\n    this.eventHeight = util.getElementHeightFromClass(this.element, cls.APPOINTMENT_CLASS);\n    var scrollTop = conWrap.scrollTop;\n\n    if (this.parent.rowAutoHeight && this.parent.virtualScrollModule && !isNullOrUndefined(this.parent.currentAction)) {\n      conWrap.scrollTop = conWrap.scrollTop - 1;\n    }\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.renderResourceEvents();\n    } else {\n      this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays);\n    }\n\n    if (this.parent.rowAutoHeight) {\n      this.updateBlockElements();\n      var data = {\n        cssProperties: this.parent.getCssProperties(),\n        module: this.parent.getModuleName(),\n        isPreventScrollUpdate: true,\n        scrollPosition: {\n          left: this.parent.uiStateValues.left,\n          top: this.parent.uiStateValues.top\n        }\n      };\n\n      if (this.parent.virtualScrollModule) {\n        if (this.parent.currentAction) {\n          conWrap.scrollTop = scrollTop;\n          this.parent.currentAction = null;\n        } else {\n          this.parent.virtualScrollModule.updateVirtualScrollHeight();\n        }\n      }\n\n      this.parent.notify(events.scrollUiUpdate, data);\n    }\n  };\n\n  MonthEvent.prototype.renderEventsHandler = function (dateRender, workDays, resData) {\n    this.renderedEvents = [];\n    var eventsList;\n    var blockList;\n    var resIndex = 0;\n\n    if (resData) {\n      resIndex = resData.groupIndex;\n      this.cssClass = resData.cssClass;\n      this.groupOrder = resData.groupOrder;\n      eventsList = this.parent.eventBase.filterEventsByResource(resData, this.parent.eventsProcessed);\n      blockList = this.parent.eventBase.filterEventsByResource(resData, this.parent.blockProcessed);\n      this.workCells = [].slice.call(this.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS + '[data-group-index=\"' + resIndex + '\"]'));\n    } else {\n      eventsList = this.parent.eventsProcessed;\n      blockList = this.parent.blockProcessed;\n      this.workCells = [].slice.call(this.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n    }\n\n    this.sortByDateTime(eventsList);\n    this.sortByDateTime(blockList);\n    this.cellWidth = this.workCells.slice(-1)[0].offsetWidth;\n    this.cellHeight = this.workCells.slice(-1)[0].offsetHeight;\n    this.dateRender = dateRender;\n    var filteredDates = this.getRenderedDates(dateRender);\n    this.getSlotDates(workDays);\n    this.processBlockEvents(blockList, resIndex, resData);\n\n    for (var _i = 0, eventsList_1 = eventsList; _i < eventsList_1.length; _i++) {\n      var event_1 = eventsList_1[_i];\n\n      if (this.parent.resourceBase && !resData) {\n        this.cssClass = this.parent.resourceBase.getCssClass(event_1);\n      }\n\n      var splittedEvents = this.splitEvent(event_1, filteredDates || this.dateRender);\n\n      for (var _a = 0, splittedEvents_1 = splittedEvents; _a < splittedEvents_1.length; _a++) {\n        var event_2 = splittedEvents_1[_a];\n        this.updateIndicatorIcon(event_2);\n        this.renderEvents(event_2, resIndex, eventsList);\n      }\n    }\n\n    this.cssClass = null;\n    this.groupOrder = null;\n  };\n\n  MonthEvent.prototype.processBlockEvents = function (blockEvents, resIndex, resData) {\n    for (var _i = 0, blockEvents_1 = blockEvents; _i < blockEvents_1.length; _i++) {\n      var event_3 = blockEvents_1[_i];\n\n      if (this.parent.resourceBase && !resData) {\n        this.cssClass = this.parent.resourceBase.getCssClass(event_3);\n      }\n\n      var blockSpannedList = [];\n\n      if (this.renderType === 'day' && !event_3[this.fields.isAllDay]) {\n        var temp = extend({}, event_3, null, true);\n        var isSameDate = this.isSameDate(temp[this.fields.startTime], temp[this.fields.endTime]);\n        temp.isBlockIcon = isSameDate;\n\n        if (!isSameDate && util.getDateInMs(temp[this.fields.startTime]) > 0) {\n          var e = extend({}, event_3, null, true);\n          e[this.fields.endTime] = util.addDays(util.resetTime(new Date(event_3[this.fields.startTime] + '')), 1);\n          e.isBlockIcon = true;\n          temp[this.fields.startTime] = e[this.fields.endTime];\n          blockSpannedList.push(e);\n        }\n\n        isSameDate = this.isSameDate(temp[this.fields.startTime], temp[this.fields.endTime]);\n\n        if (!isSameDate && util.getDateInMs(temp[this.fields.endTime]) > 0) {\n          var e = extend({}, event_3, null, true);\n          e[this.fields.startTime] = util.resetTime(new Date(event_3[this.fields.endTime] + ''));\n          e.isBlockIcon = true;\n          blockSpannedList.push(e);\n          temp[this.fields.endTime] = e[this.fields.startTime];\n        }\n\n        blockSpannedList.push(temp);\n      } else {\n        blockSpannedList.push(event_3);\n      }\n\n      for (var _a = 0, blockSpannedList_1 = blockSpannedList; _a < blockSpannedList_1.length; _a++) {\n        var blockEvent = blockSpannedList_1[_a];\n        var splittedEvents = this.splitEvent(blockEvent, this.dateRender);\n\n        for (var _b = 0, splittedEvents_2 = splittedEvents; _b < splittedEvents_2.length; _b++) {\n          var event_4 = splittedEvents_2[_b];\n          this.renderBlockEvents(event_4, resIndex, !!blockEvent.isBlockIcon);\n        }\n      }\n    }\n  };\n\n  MonthEvent.prototype.isSameDate = function (start, end) {\n    return new Date(+start).setHours(0, 0, 0, 0) === new Date(+end).setHours(0, 0, 0, 0);\n  };\n\n  MonthEvent.prototype.renderBlockEvents = function (event, resIndex, isIcon) {\n    var eventData = event.data;\n    var startTime = this.getStartTime(event, eventData);\n    var endTime = this.getEndTime(event, eventData);\n    var day = this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(startTime.getTime())));\n\n    if (day < 0 || startTime > endTime) {\n      return;\n    }\n\n    var cellTd = this.getCellTd(day);\n    var position = this.getPosition(startTime, endTime, event[this.fields.isAllDay], day);\n\n    if (!isIcon) {\n      var diffInDays = eventData.count;\n      var appWidth = this.getEventWidth(startTime, endTime, event[this.fields.isAllDay], diffInDays);\n      appWidth = appWidth <= 0 ? this.cellWidth : appWidth;\n      var appLeft = this.parent.enableRtl ? 0 : position;\n      var appRight = this.parent.enableRtl ? position : 0;\n      this.renderWrapperElement(cellTd);\n      var appHeight = this.cellHeight - this.monthHeaderHeight;\n      var appTop = this.getRowTop(resIndex);\n      var blockElement = this.createBlockAppointmentElement(event, resIndex);\n      setStyleAttribute(blockElement, {\n        'width': appWidth + 'px',\n        'height': appHeight + 1 + 'px',\n        'left': appLeft + 'px',\n        'right': appRight + 'px',\n        'top': appTop + 'px'\n      });\n      this.renderEventElement(event, blockElement, cellTd);\n    } else {\n      this.renderBlockIndicator(cellTd, position, resIndex);\n    }\n  };\n\n  MonthEvent.prototype.renderBlockIndicator = function (cellTd, position, resIndex) {\n    var blockIndicator = createElement('div', {\n      className: 'e-icons ' + cls.BLOCK_INDICATOR_CLASS\n    });\n\n    if (isNullOrUndefined(cellTd.querySelector('.' + cls.BLOCK_INDICATOR_CLASS))) {\n      cellTd.appendChild(blockIndicator);\n    }\n  };\n\n  MonthEvent.prototype.getStartTime = function (event, eventData) {\n    return event[this.fields.startTime];\n  };\n\n  MonthEvent.prototype.getEndTime = function (event, eventData) {\n    return event[this.fields.endTime];\n  };\n\n  MonthEvent.prototype.getCellTd = function (day) {\n    return this.workCells[day];\n  };\n\n  MonthEvent.prototype.getEventWidth = function (startDate, endDate, isAllDay, count) {\n    return count * this.cellWidth - 1;\n  };\n\n  MonthEvent.prototype.getPosition = function (startTime, endTime, isAllDay, day) {\n    return 0;\n  };\n\n  MonthEvent.prototype.getRowTop = function (resIndex) {\n    return 0;\n  };\n\n  MonthEvent.prototype.updateIndicatorIcon = function (event) {\n    if (this.parent.currentView.indexOf('Timeline') === -1 || this.parent.currentView === 'TimelineMonth' || event[this.fields.isAllDay]) {\n      return;\n    }\n\n    var cloneData = event.data;\n    var startHour = util.getStartEndHours(event[this.fields.startTime], this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n    var endHour = util.getStartEndHours(event[this.fields.endTime], this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n    cloneData.isLeft = cloneData.isLeft || cloneData[this.fields.startTime].getTime() < startHour.startHour.getTime();\n    cloneData.isRight = cloneData.isRight || cloneData[this.fields.endTime].getTime() > endHour.endHour.getTime();\n  };\n\n  MonthEvent.prototype.renderResourceEvents = function () {\n    var resources = this.parent.uiStateValues.isGroupAdaptive ? [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] : this.parent.resourceBase.lastResourceLevel;\n\n    for (var _i = 0, resources_1 = resources; _i < resources_1.length; _i++) {\n      var slotData = resources_1[_i];\n      this.renderEventsHandler(slotData.renderDates, slotData.workDays, slotData);\n    }\n  };\n\n  MonthEvent.prototype.getSlotDates = function (workDays) {\n    this.slots = [];\n    var dates = this.dateRender.map(function (date) {\n      return +date;\n    });\n    var noOfDays = this.parent.activeViewOptions.showWeekend ? util.WEEK_LENGTH : workDays.length;\n\n    while (dates.length > 0) {\n      this.slots.push(dates.splice(0, noOfDays));\n    }\n  };\n\n  MonthEvent.prototype.createAppointmentElement = function (record, resIndex, isCloneElement) {\n    if (isCloneElement === void 0) {\n      isCloneElement = false;\n    }\n\n    var eventSubject = record[this.fields.subject] || this.parent.eventSettings.fields.subject.default;\n    var appointmentWrapper = createElement('div', {\n      className: cls.APPOINTMENT_CLASS,\n      attrs: {\n        'data-id': 'Appointment_' + record[this.fields.id],\n        'role': 'button',\n        'tabindex': '0',\n        'aria-readonly': this.parent.eventBase.getReadonlyAttribute(record),\n        'aria-selected': 'false',\n        'aria-grabbed': 'true'\n      }\n    });\n\n    if (!isCloneElement) {\n      appointmentWrapper.setAttribute('data-guid', record.Guid);\n    }\n\n    if (!isNullOrUndefined(this.cssClass)) {\n      addClass([appointmentWrapper], this.cssClass);\n    }\n\n    if (record[this.fields.isReadonly]) {\n      addClass([appointmentWrapper], 'e-read-only');\n    }\n\n    var appointmentDetails = createElement('div', {\n      className: cls.APPOINTMENT_DETAILS\n    });\n    appointmentWrapper.appendChild(appointmentDetails);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      appointmentWrapper.setAttribute('data-group-index', resIndex.toString());\n    }\n\n    var templateElement;\n    var eventData = record.data;\n    var eventObj = this.getEventData(record);\n\n    if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n      var scheduleId = this.parent.element.id + '_';\n      var viewName = this.parent.activeViewOptions.eventTemplateName;\n      var templateId = scheduleId + viewName + 'eventTemplate';\n      var templateArgs = util.addLocalOffsetToEvent(eventObj, this.parent.eventFields);\n      templateElement = this.parent.getAppointmentTemplate()(templateArgs, this.parent, 'eventTemplate', templateId, false);\n    } else {\n      var eventLocation = record[this.fields.location] || this.parent.eventSettings.fields.location.default || '';\n      var appointmentSubject = createElement('div', {\n        className: cls.SUBJECT_CLASS,\n        innerHTML: eventSubject + (eventLocation ? ';&nbsp' + eventLocation : '')\n      });\n      var appointmentStartTime = createElement('div', {\n        className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\n        innerHTML: this.parent.getTimeString(eventData[this.fields.startTime])\n      });\n      var appointmentEndTime = createElement('div', {\n        className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\n        innerHTML: this.parent.getTimeString(eventData[this.fields.endTime])\n      });\n\n      if (this.parent.currentView === 'Month') {\n        if (record[this.fields.isAllDay]) {\n          templateElement = [appointmentSubject];\n          addClass([appointmentSubject], 'e-text-center');\n        } else if (eventData.count <= 1 && !eventData.isLeft && !eventData.isRight) {\n          templateElement = [appointmentStartTime, appointmentSubject];\n        } else {\n          templateElement = [];\n          addClass([appointmentSubject], 'e-text-center');\n\n          if (!eventData.isLeft) {\n            templateElement.push(appointmentStartTime);\n          }\n\n          templateElement.push(appointmentSubject);\n\n          if (!eventData.isRight) {\n            templateElement.push(appointmentEndTime);\n          }\n        }\n      } else {\n        var innerElement = void 0;\n\n        if (record[this.fields.isAllDay]) {\n          var allDayString = createElement('div', {\n            className: cls.APPOINTMENT_TIME,\n            innerHTML: this.parent.localeObj.getConstant('allDay')\n          });\n          innerElement = [appointmentSubject, allDayString];\n        } else {\n          var timeString = this.parent.getTimeString(eventData[this.fields.startTime]) + ' - ' + this.parent.getTimeString(eventData[this.fields.endTime]);\n          var appTime = createElement('div', {\n            className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\n            innerHTML: timeString\n          });\n          var appLocation = createElement('div', {\n            className: cls.LOCATION_CLASS,\n            innerHTML: eventLocation\n          });\n          innerElement = [appointmentSubject, appTime, appLocation];\n        }\n\n        var wrap = createElement('div', {\n          className: 'e-inner-wrap'\n        });\n        append(innerElement, wrap);\n        templateElement = [wrap];\n      }\n    }\n\n    append(templateElement, appointmentDetails);\n    this.appendEventIcons(record, appointmentDetails);\n    this.renderResizeHandler(appointmentWrapper, record.data, record[this.fields.isReadonly]);\n    return appointmentWrapper;\n  };\n\n  MonthEvent.prototype.appendEventIcons = function (record, appointmentDetails) {\n    var eventData = record.data;\n\n    if (!isNullOrUndefined(record[this.fields.recurrenceRule]) || !isNullOrUndefined(record[this.fields.recurrenceID])) {\n      var iconClass = record[this.fields.id] === record[this.fields.recurrenceID] ? cls.EVENT_RECURRENCE_ICON_CLASS : cls.EVENT_RECURRENCE_EDIT_ICON_CLASS;\n      appointmentDetails.appendChild(createElement('div', {\n        className: cls.ICON + ' ' + iconClass + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : '')\n      }));\n    }\n\n    if (eventData.isLeft) {\n      var iconLeft = createElement('div', {\n        className: cls.EVENT_INDICATOR_CLASS + ' ' + cls.ICON + ' ' + cls.EVENT_ICON_LEFT_CLASS\n      });\n      prepend([iconLeft], appointmentDetails);\n    }\n\n    if (eventData.isRight) {\n      var iconRight = createElement('div', {\n        className: cls.EVENT_INDICATOR_CLASS + ' ' + cls.ICON + ' ' + cls.EVENT_ICON_RIGHT_CLASS\n      });\n      append([iconRight], appointmentDetails);\n    }\n  };\n\n  MonthEvent.prototype.renderEvents = function (event, resIndex, eventsList) {\n    var startTime = event[this.fields.startTime];\n    var endTime = event[this.fields.endTime];\n    var day = this.parent.getIndexOfDate(this.dateRender, util.resetTime(startTime));\n\n    if (day < 0) {\n      return;\n    }\n\n    if (startTime.getTime() < this.parent.minDate.getTime() || endTime.getTime() > this.parent.maxDate.getTime()) {\n      return;\n    }\n\n    var overlapCount = this.getIndex(startTime);\n    event.Index = overlapCount;\n    var appHeight = this.eventHeight;\n    this.renderedEvents.push(extend({}, event, null, true));\n    var diffInDays = event.data.count;\n\n    if (startTime.getTime() <= endTime.getTime()) {\n      var appWidth = diffInDays * this.cellWidth - 5;\n      var cellTd = this.workCells[day];\n      var appTop = overlapCount * (appHeight + EVENT_GAP);\n      this.renderWrapperElement(cellTd);\n      var height = this.monthHeaderHeight + (overlapCount + 1) * (appHeight + EVENT_GAP) + this.moreIndicatorHeight;\n\n      if (this.cellHeight > height || this.parent.rowAutoHeight) {\n        var appointmentElement = this.createAppointmentElement(event, resIndex);\n        this.applyResourceColor(appointmentElement, event, 'backgroundColor', this.groupOrder);\n        this.wireAppointmentEvents(appointmentElement, event);\n        setStyleAttribute(appointmentElement, {\n          'width': appWidth + 'px',\n          'top': appTop + 'px'\n        });\n        this.renderEventElement(event, appointmentElement, cellTd);\n\n        if (this.parent.rowAutoHeight) {\n          var firstChild = cellTd.parentElement.firstElementChild;\n          this.updateCellHeight(firstChild, height);\n        }\n      } else {\n        for (var i = 0; i < diffInDays; i++) {\n          var cellTd_1 = this.workCells[day + i];\n\n          if (cellTd_1 && isNullOrUndefined(cellTd_1.querySelector('.' + cls.MORE_INDICATOR_CLASS))) {\n            var startDate = new Date(this.dateRender[day + i].getTime());\n            var endDate = util.addDays(this.dateRender[day + i], 1);\n            var groupIndex = cellTd_1.getAttribute('data-group-index');\n            var filterEvents = this.getFilteredEvents(startDate, endDate, groupIndex);\n            var appArea = this.cellHeight - this.monthHeaderHeight - this.moreIndicatorHeight;\n            var renderedAppCount = Math.floor(appArea / (appHeight + EVENT_GAP));\n            var count = filterEvents.length - renderedAppCount <= 0 ? 1 : filterEvents.length - renderedAppCount;\n            var moreIndicatorElement = this.getMoreIndicatorElement(count, startDate, endDate);\n\n            if (!isNullOrUndefined(groupIndex)) {\n              moreIndicatorElement.setAttribute('data-group-index', groupIndex);\n            }\n\n            moreIndicatorElement.style.top = appArea + 'px';\n            moreIndicatorElement.style.width = cellTd_1.offsetWidth - 2 + 'px';\n            this.renderElement(cellTd_1, moreIndicatorElement);\n            EventHandler.add(moreIndicatorElement, 'click', this.moreIndicatorClick, this);\n          }\n        }\n      }\n    }\n  };\n\n  MonthEvent.prototype.updateCellHeight = function (cell, height) {\n    if (height > cell.offsetHeight) {\n      setStyleAttribute(cell, {\n        'height': height + 'px'\n      });\n    }\n  };\n\n  MonthEvent.prototype.updateBlockElements = function () {\n    var blockElement = [].slice.call(this.element.querySelectorAll('.' + cls.BLOCK_APPOINTMENT_CLASS));\n\n    for (var _i = 0, blockElement_1 = blockElement; _i < blockElement_1.length; _i++) {\n      var element = blockElement_1[_i];\n      var target = closest(element, 'tr');\n      this.monthHeaderHeight = element.offsetParent.offsetTop - target.offsetTop;\n      element.style.height = target.offsetHeight - 1 - this.monthHeaderHeight + 'px';\n      var firstChild = target.firstElementChild;\n      var width = Math.round(element.offsetWidth / firstChild.offsetWidth);\n      element.style.width = firstChild.offsetWidth * width + 'px';\n    }\n  };\n\n  MonthEvent.prototype.getFilteredEvents = function (startDate, endDate, groupIndex, eventsList) {\n    var filteredEvents;\n\n    if (isNullOrUndefined(groupIndex)) {\n      filteredEvents = this.filterEvents(startDate, endDate);\n    } else {\n      var data = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)];\n      filteredEvents = this.filterEvents(startDate, endDate, isNullOrUndefined(eventsList) ? undefined : eventsList, data);\n    }\n\n    return filteredEvents;\n  };\n\n  MonthEvent.prototype.getOverlapEvents = function (date, appointments) {\n    var appointmentsList = [];\n\n    for (var _i = 0, appointments_1 = appointments; _i < appointments_1.length; _i++) {\n      var app = appointments_1[_i];\n\n      if (util.resetTime(app[this.fields.startTime]).getTime() <= util.resetTime(date).getTime() && util.resetTime(app[this.fields.endTime]).getTime() >= util.resetTime(date).getTime()) {\n        appointmentsList.push(app);\n      }\n    }\n\n    return appointmentsList;\n  };\n\n  MonthEvent.prototype.getIndex = function (date) {\n    var appIndex = -1;\n    var appointments = this.renderedEvents;\n\n    if (appointments.length > 0) {\n      var appointmentsList = this.getOverlapEvents(date, appointments);\n      var appLevel = appointmentsList.map(function (obj) {\n        return obj.Index;\n      });\n      appIndex = appLevel.length > 0 ? this.getSmallestMissingNumber(appLevel) : 0;\n    }\n\n    return appIndex === -1 ? 0 : appIndex;\n  };\n\n  MonthEvent.prototype.moreIndicatorClick = function (event) {\n    var _this = this;\n\n    var target = closest(event.target, '.' + cls.MORE_INDICATOR_CLASS);\n    var startDate = new Date(parseInt(target.getAttribute('data-start-date'), 10));\n    var endDate = new Date(parseInt(target.getAttribute('data-end-date'), 10));\n    var groupIndex = target.getAttribute('data-group-index');\n    var moreArgs = {\n      cancel: false,\n      event: event,\n      element: target,\n      isPopupOpen: true,\n      startTime: startDate,\n      endTime: endDate,\n      viewName: this.parent.getNavigateView()\n    };\n\n    if (groupIndex) {\n      moreArgs.groupIndex = parseInt(groupIndex, 10);\n    }\n\n    this.parent.trigger(events.moreEventsClick, moreArgs, function (clickArgs) {\n      if (isBlazor()) {\n        clickArgs.startTime = new Date('' + clickArgs.startTime);\n        clickArgs.endTime = new Date('' + clickArgs.endTime);\n        clickArgs.element = getElement(clickArgs.element);\n      }\n\n      if (!clickArgs.cancel) {\n        if (clickArgs.isPopupOpen) {\n          var filteredEvents = _this.getFilteredEvents(startDate, endDate, groupIndex);\n\n          var moreEventArgs = {\n            date: startDate,\n            event: filteredEvents,\n            element: event.target\n          };\n\n          _this.parent.quickPopup.moreEventClick(moreEventArgs, endDate, groupIndex);\n        } else {\n          _this.parent.setScheduleProperties({\n            selectedDate: startDate\n          });\n\n          _this.parent.changeView(clickArgs.viewName, event);\n        }\n      }\n    });\n  };\n\n  MonthEvent.prototype.renderEventElement = function (event, appointmentElement, cellTd) {\n    var _this = this;\n\n    var eventType = appointmentElement.classList.contains(cls.BLOCK_APPOINTMENT_CLASS) ? 'blockEvent' : 'event';\n    var eventObj = this.getEventData(event);\n    var args = {\n      data: eventObj,\n      element: appointmentElement,\n      cancel: false,\n      type: eventType\n    };\n    this.parent.trigger(events.eventRendered, args, function (eventArgs) {\n      if (eventArgs.cancel) {\n        _this.renderedEvents.pop();\n      } else {\n        _this.renderElement(cellTd, appointmentElement);\n      }\n    });\n  };\n\n  MonthEvent.prototype.getEventData = function (event) {\n    var eventObj = extend({}, event, null, true);\n    eventObj[this.fields.startTime] = event.data[this.fields.startTime];\n    eventObj[this.fields.endTime] = event.data[this.fields.endTime];\n    return eventObj;\n  };\n\n  MonthEvent.prototype.renderElement = function (cellTd, element) {\n    if (cellTd.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS)) {\n      cellTd.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS).appendChild(element);\n    } else {\n      var wrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      wrapper.appendChild(element);\n      cellTd.appendChild(wrapper);\n    }\n  };\n\n  MonthEvent.prototype.renderWrapperElement = function (cellTd) {\n    var element = cellTd.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n    if (!isNullOrUndefined(element)) {\n      this.monthHeaderHeight = element.offsetTop - cellTd.offsetTop;\n    } else {\n      var wrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      cellTd.appendChild(wrapper);\n      this.monthHeaderHeight = wrapper.offsetTop - cellTd.offsetTop;\n    }\n  };\n\n  MonthEvent.prototype.getMoreIndicatorElement = function (count, startDate, endDate) {\n    var moreIndicatorElement = createElement('div', {\n      className: cls.MORE_INDICATOR_CLASS,\n      innerHTML: '+' + count + '&nbsp;' + (this.parent.isAdaptive ? '' : this.parent.localeObj.getConstant('more')),\n      attrs: {\n        'tabindex': '0',\n        'data-start-date': startDate.getTime().toString(),\n        'data-end-date': endDate.getTime().toString(),\n        'role': 'list'\n      }\n    });\n    return moreIndicatorElement;\n  };\n\n  MonthEvent.prototype.removeHeightProperty = function (selector) {\n    var rows = [].slice.call(this.element.querySelectorAll('.' + selector + ' tbody tr'));\n\n    for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n      var row = rows_1[_i];\n      row.firstElementChild.style.height = '';\n    }\n  };\n\n  return MonthEvent;\n}(EventBase);\n\nexport { MonthEvent };","map":{"version":3,"sources":["C:/Users/grigo/OneDrive/Рабочий стол/CRM/node_modules/@syncfusion/ej2-schedule/src/schedule/event-renderer/month.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","append","prepend","createElement","extend","EventHandler","closest","addClass","isBlazor","getElement","isNullOrUndefined","setStyleAttribute","remove","EventBase","cls","events","util","EVENT_GAP","MonthEvent","_super","parent","_this","call","renderedEvents","monthHeaderHeight","moreIndicatorHeight","renderType","element","activeView","getPanel","fields","eventFields","addEventListener","renderAppointments","conWrap","querySelector","CONTENT_WRAP_CLASS","rowAutoHeight","uiStateValues","top","scrollTop","left","scrollLeft","appointmentWrapper","slice","querySelectorAll","APPOINTMENT_WRAPPER_CLASS","_i","appointmentWrapper_1","length","wrap","removeHeightProperty","CONTENT_TABLE_CLASS","WORK_CELLS_CLASS","eventHeight","getElementHeightFromClass","APPOINTMENT_CLASS","virtualScrollModule","currentAction","activeViewOptions","group","resources","renderResourceEvents","renderEventsHandler","renderDates","workDays","updateBlockElements","data","cssProperties","getCssProperties","module","getModuleName","isPreventScrollUpdate","scrollPosition","updateVirtualScrollHeight","notify","scrollUiUpdate","dateRender","resData","eventsList","blockList","resIndex","groupIndex","cssClass","groupOrder","eventBase","filterEventsByResource","eventsProcessed","blockProcessed","workCells","sortByDateTime","cellWidth","offsetWidth","cellHeight","offsetHeight","filteredDates","getRenderedDates","getSlotDates","processBlockEvents","eventsList_1","event_1","resourceBase","getCssClass","splittedEvents","splitEvent","_a","splittedEvents_1","event_2","updateIndicatorIcon","renderEvents","blockEvents","blockEvents_1","event_3","blockSpannedList","isAllDay","temp","isSameDate","startTime","endTime","isBlockIcon","getDateInMs","e","addDays","resetTime","Date","push","blockSpannedList_1","blockEvent","_b","splittedEvents_2","event_4","renderBlockEvents","start","end","setHours","event","isIcon","eventData","getStartTime","getEndTime","day","getIndexOfDate","getTime","cellTd","getCellTd","position","getPosition","diffInDays","count","appWidth","getEventWidth","appLeft","enableRtl","appRight","renderWrapperElement","appHeight","appTop","getRowTop","blockElement","createBlockAppointmentElement","renderEventElement","renderBlockIndicator","blockIndicator","className","BLOCK_INDICATOR_CLASS","appendChild","startDate","endDate","currentView","indexOf","cloneData","startHour","getStartEndHours","getStartHour","getEndHour","endHour","isLeft","isRight","isGroupAdaptive","lastResourceLevel","resources_1","slotData","slots","dates","map","date","noOfDays","showWeekend","WEEK_LENGTH","splice","createAppointmentElement","record","isCloneElement","eventSubject","subject","eventSettings","default","attrs","id","getReadonlyAttribute","setAttribute","Guid","isReadonly","appointmentDetails","APPOINTMENT_DETAILS","toString","templateElement","eventObj","getEventData","eventTemplate","scheduleId","viewName","eventTemplateName","templateId","templateArgs","addLocalOffsetToEvent","getAppointmentTemplate","eventLocation","location","appointmentSubject","SUBJECT_CLASS","innerHTML","appointmentStartTime","APPOINTMENT_TIME","isAdaptive","DISABLE_CLASS","getTimeString","appointmentEndTime","innerElement","allDayString","localeObj","getConstant","timeString","appTime","appLocation","LOCATION_CLASS","appendEventIcons","renderResizeHandler","recurrenceRule","recurrenceID","iconClass","EVENT_RECURRENCE_ICON_CLASS","EVENT_RECURRENCE_EDIT_ICON_CLASS","ICON","iconLeft","EVENT_INDICATOR_CLASS","EVENT_ICON_LEFT_CLASS","iconRight","EVENT_ICON_RIGHT_CLASS","minDate","maxDate","overlapCount","getIndex","Index","height","appointmentElement","applyResourceColor","wireAppointmentEvents","firstChild","parentElement","firstElementChild","updateCellHeight","i","cellTd_1","MORE_INDICATOR_CLASS","getAttribute","filterEvents","getFilteredEvents","appArea","renderedAppCount","Math","floor","moreIndicatorElement","getMoreIndicatorElement","style","width","renderElement","add","moreIndicatorClick","cell","BLOCK_APPOINTMENT_CLASS","blockElement_1","target","offsetParent","offsetTop","round","filteredEvents","parseInt","undefined","getOverlapEvents","appointments","appointmentsList","appointments_1","app","appIndex","appLevel","obj","getSmallestMissingNumber","moreArgs","cancel","isPopupOpen","getNavigateView","trigger","moreEventsClick","clickArgs","moreEventArgs","quickPopup","moreEventClick","setScheduleProperties","selectedDate","changeView","eventType","classList","contains","args","type","eventRendered","eventArgs","pop","wrapper","selector","rows","rows_1","row"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { append, prepend, createElement, extend, EventHandler, closest, addClass, isBlazor, getElement } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, setStyleAttribute, remove } from '@syncfusion/ej2-base';\nimport { EventBase } from './event-base';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar EVENT_GAP = 0;\n/**\n * Month view events render\n */\nvar MonthEvent = /** @class */ (function (_super) {\n    __extends(MonthEvent, _super);\n    /**\n     * Constructor for month events\n     */\n    function MonthEvent(parent) {\n        var _this = _super.call(this, parent) || this;\n        _this.renderedEvents = [];\n        _this.monthHeaderHeight = 0;\n        _this.moreIndicatorHeight = 19;\n        _this.renderType = 'day';\n        _this.element = _this.parent.activeView.getPanel();\n        _this.fields = _this.parent.eventFields;\n        _this.addEventListener();\n        return _this;\n    }\n    MonthEvent.prototype.renderAppointments = function () {\n        var conWrap = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        if (this.parent.rowAutoHeight) {\n            this.parent.uiStateValues.top = conWrap.scrollTop;\n            this.parent.uiStateValues.left = conWrap.scrollLeft;\n        }\n        var appointmentWrapper = [].slice.call(this.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\n        for (var _i = 0, appointmentWrapper_1 = appointmentWrapper; _i < appointmentWrapper_1.length; _i++) {\n            var wrap = appointmentWrapper_1[_i];\n            remove(wrap);\n        }\n        this.removeHeightProperty(cls.CONTENT_TABLE_CLASS);\n        if (!this.element.querySelector('.' + cls.WORK_CELLS_CLASS)) {\n            return;\n        }\n        this.eventHeight = util.getElementHeightFromClass(this.element, cls.APPOINTMENT_CLASS);\n        var scrollTop = conWrap.scrollTop;\n        if (this.parent.rowAutoHeight && this.parent.virtualScrollModule && !isNullOrUndefined(this.parent.currentAction)) {\n            conWrap.scrollTop = conWrap.scrollTop - 1;\n        }\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.renderResourceEvents();\n        }\n        else {\n            this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays);\n        }\n        if (this.parent.rowAutoHeight) {\n            this.updateBlockElements();\n            var data = {\n                cssProperties: this.parent.getCssProperties(),\n                module: this.parent.getModuleName(),\n                isPreventScrollUpdate: true,\n                scrollPosition: { left: this.parent.uiStateValues.left, top: this.parent.uiStateValues.top }\n            };\n            if (this.parent.virtualScrollModule) {\n                if (this.parent.currentAction) {\n                    conWrap.scrollTop = scrollTop;\n                    this.parent.currentAction = null;\n                }\n                else {\n                    this.parent.virtualScrollModule.updateVirtualScrollHeight();\n                }\n            }\n            this.parent.notify(events.scrollUiUpdate, data);\n        }\n    };\n    MonthEvent.prototype.renderEventsHandler = function (dateRender, workDays, resData) {\n        this.renderedEvents = [];\n        var eventsList;\n        var blockList;\n        var resIndex = 0;\n        if (resData) {\n            resIndex = resData.groupIndex;\n            this.cssClass = resData.cssClass;\n            this.groupOrder = resData.groupOrder;\n            eventsList = this.parent.eventBase.filterEventsByResource(resData, this.parent.eventsProcessed);\n            blockList = this.parent.eventBase.filterEventsByResource(resData, this.parent.blockProcessed);\n            this.workCells = [].slice.call(this.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS + '[data-group-index=\"' + resIndex + '\"]'));\n        }\n        else {\n            eventsList = this.parent.eventsProcessed;\n            blockList = this.parent.blockProcessed;\n            this.workCells = [].slice.call(this.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n        }\n        this.sortByDateTime(eventsList);\n        this.sortByDateTime(blockList);\n        this.cellWidth = this.workCells.slice(-1)[0].offsetWidth;\n        this.cellHeight = this.workCells.slice(-1)[0].offsetHeight;\n        this.dateRender = dateRender;\n        var filteredDates = this.getRenderedDates(dateRender);\n        this.getSlotDates(workDays);\n        this.processBlockEvents(blockList, resIndex, resData);\n        for (var _i = 0, eventsList_1 = eventsList; _i < eventsList_1.length; _i++) {\n            var event_1 = eventsList_1[_i];\n            if (this.parent.resourceBase && !resData) {\n                this.cssClass = this.parent.resourceBase.getCssClass(event_1);\n            }\n            var splittedEvents = this.splitEvent(event_1, filteredDates || this.dateRender);\n            for (var _a = 0, splittedEvents_1 = splittedEvents; _a < splittedEvents_1.length; _a++) {\n                var event_2 = splittedEvents_1[_a];\n                this.updateIndicatorIcon(event_2);\n                this.renderEvents(event_2, resIndex, eventsList);\n            }\n        }\n        this.cssClass = null;\n        this.groupOrder = null;\n    };\n    MonthEvent.prototype.processBlockEvents = function (blockEvents, resIndex, resData) {\n        for (var _i = 0, blockEvents_1 = blockEvents; _i < blockEvents_1.length; _i++) {\n            var event_3 = blockEvents_1[_i];\n            if (this.parent.resourceBase && !resData) {\n                this.cssClass = this.parent.resourceBase.getCssClass(event_3);\n            }\n            var blockSpannedList = [];\n            if (this.renderType === 'day' && !event_3[this.fields.isAllDay]) {\n                var temp = extend({}, event_3, null, true);\n                var isSameDate = this.isSameDate(temp[this.fields.startTime], temp[this.fields.endTime]);\n                temp.isBlockIcon = isSameDate;\n                if (!isSameDate && util.getDateInMs(temp[this.fields.startTime]) > 0) {\n                    var e = extend({}, event_3, null, true);\n                    e[this.fields.endTime] = util.addDays(util.resetTime(new Date(event_3[this.fields.startTime] + '')), 1);\n                    e.isBlockIcon = true;\n                    temp[this.fields.startTime] = e[this.fields.endTime];\n                    blockSpannedList.push(e);\n                }\n                isSameDate = this.isSameDate(temp[this.fields.startTime], temp[this.fields.endTime]);\n                if (!isSameDate && util.getDateInMs(temp[this.fields.endTime]) > 0) {\n                    var e = extend({}, event_3, null, true);\n                    e[this.fields.startTime] = util.resetTime(new Date(event_3[this.fields.endTime] + ''));\n                    e.isBlockIcon = true;\n                    blockSpannedList.push(e);\n                    temp[this.fields.endTime] = e[this.fields.startTime];\n                }\n                blockSpannedList.push(temp);\n            }\n            else {\n                blockSpannedList.push(event_3);\n            }\n            for (var _a = 0, blockSpannedList_1 = blockSpannedList; _a < blockSpannedList_1.length; _a++) {\n                var blockEvent = blockSpannedList_1[_a];\n                var splittedEvents = this.splitEvent(blockEvent, this.dateRender);\n                for (var _b = 0, splittedEvents_2 = splittedEvents; _b < splittedEvents_2.length; _b++) {\n                    var event_4 = splittedEvents_2[_b];\n                    this.renderBlockEvents(event_4, resIndex, !!blockEvent.isBlockIcon);\n                }\n            }\n        }\n    };\n    MonthEvent.prototype.isSameDate = function (start, end) {\n        return new Date(+start).setHours(0, 0, 0, 0) === new Date(+end).setHours(0, 0, 0, 0);\n    };\n    MonthEvent.prototype.renderBlockEvents = function (event, resIndex, isIcon) {\n        var eventData = event.data;\n        var startTime = this.getStartTime(event, eventData);\n        var endTime = this.getEndTime(event, eventData);\n        var day = this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(startTime.getTime())));\n        if (day < 0 || startTime > endTime) {\n            return;\n        }\n        var cellTd = this.getCellTd(day);\n        var position = this.getPosition(startTime, endTime, event[this.fields.isAllDay], day);\n        if (!isIcon) {\n            var diffInDays = eventData.count;\n            var appWidth = this.getEventWidth(startTime, endTime, event[this.fields.isAllDay], diffInDays);\n            appWidth = (appWidth <= 0) ? this.cellWidth : appWidth;\n            var appLeft = (this.parent.enableRtl) ? 0 : position;\n            var appRight = (this.parent.enableRtl) ? position : 0;\n            this.renderWrapperElement(cellTd);\n            var appHeight = this.cellHeight - this.monthHeaderHeight;\n            var appTop = this.getRowTop(resIndex);\n            var blockElement = this.createBlockAppointmentElement(event, resIndex);\n            setStyleAttribute(blockElement, {\n                'width': appWidth + 'px', 'height': appHeight + 1 + 'px', 'left': appLeft + 'px',\n                'right': appRight + 'px', 'top': appTop + 'px'\n            });\n            this.renderEventElement(event, blockElement, cellTd);\n        }\n        else {\n            this.renderBlockIndicator(cellTd, position, resIndex);\n        }\n    };\n    MonthEvent.prototype.renderBlockIndicator = function (cellTd, position, resIndex) {\n        var blockIndicator = createElement('div', { className: 'e-icons ' + cls.BLOCK_INDICATOR_CLASS });\n        if (isNullOrUndefined(cellTd.querySelector('.' + cls.BLOCK_INDICATOR_CLASS))) {\n            cellTd.appendChild(blockIndicator);\n        }\n    };\n    MonthEvent.prototype.getStartTime = function (event, eventData) {\n        return event[this.fields.startTime];\n    };\n    MonthEvent.prototype.getEndTime = function (event, eventData) {\n        return event[this.fields.endTime];\n    };\n    MonthEvent.prototype.getCellTd = function (day) {\n        return this.workCells[day];\n    };\n    MonthEvent.prototype.getEventWidth = function (startDate, endDate, isAllDay, count) {\n        return count * this.cellWidth - 1;\n    };\n    MonthEvent.prototype.getPosition = function (startTime, endTime, isAllDay, day) {\n        return 0;\n    };\n    MonthEvent.prototype.getRowTop = function (resIndex) {\n        return 0;\n    };\n    MonthEvent.prototype.updateIndicatorIcon = function (event) {\n        if (this.parent.currentView.indexOf('Timeline') === -1 || this.parent.currentView === 'TimelineMonth'\n            || event[this.fields.isAllDay]) {\n            return;\n        }\n        var cloneData = event.data;\n        var startHour = util.getStartEndHours(event[this.fields.startTime], this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n        var endHour = util.getStartEndHours(event[this.fields.endTime], this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n        cloneData.isLeft = cloneData.isLeft || cloneData[this.fields.startTime].getTime() < startHour.startHour.getTime();\n        cloneData.isRight = cloneData.isRight || cloneData[this.fields.endTime].getTime() > endHour.endHour.getTime();\n    };\n    MonthEvent.prototype.renderResourceEvents = function () {\n        var resources = this.parent.uiStateValues.isGroupAdaptive ?\n            [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] :\n            this.parent.resourceBase.lastResourceLevel;\n        for (var _i = 0, resources_1 = resources; _i < resources_1.length; _i++) {\n            var slotData = resources_1[_i];\n            this.renderEventsHandler(slotData.renderDates, slotData.workDays, slotData);\n        }\n    };\n    MonthEvent.prototype.getSlotDates = function (workDays) {\n        this.slots = [];\n        var dates = this.dateRender.map(function (date) { return +date; });\n        var noOfDays = this.parent.activeViewOptions.showWeekend ? util.WEEK_LENGTH : workDays.length;\n        while (dates.length > 0) {\n            this.slots.push(dates.splice(0, noOfDays));\n        }\n    };\n    MonthEvent.prototype.createAppointmentElement = function (record, resIndex, isCloneElement) {\n        if (isCloneElement === void 0) { isCloneElement = false; }\n        var eventSubject = (record[this.fields.subject] || this.parent.eventSettings.fields.subject.default);\n        var appointmentWrapper = createElement('div', {\n            className: cls.APPOINTMENT_CLASS,\n            attrs: {\n                'data-id': 'Appointment_' + record[this.fields.id],\n                'role': 'button', 'tabindex': '0',\n                'aria-readonly': this.parent.eventBase.getReadonlyAttribute(record), 'aria-selected': 'false', 'aria-grabbed': 'true'\n            }\n        });\n        if (!isCloneElement) {\n            appointmentWrapper.setAttribute('data-guid', record.Guid);\n        }\n        if (!isNullOrUndefined(this.cssClass)) {\n            addClass([appointmentWrapper], this.cssClass);\n        }\n        if (record[this.fields.isReadonly]) {\n            addClass([appointmentWrapper], 'e-read-only');\n        }\n        var appointmentDetails = createElement('div', { className: cls.APPOINTMENT_DETAILS });\n        appointmentWrapper.appendChild(appointmentDetails);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            appointmentWrapper.setAttribute('data-group-index', resIndex.toString());\n        }\n        var templateElement;\n        var eventData = record.data;\n        var eventObj = this.getEventData(record);\n        if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n            var scheduleId = this.parent.element.id + '_';\n            var viewName = this.parent.activeViewOptions.eventTemplateName;\n            var templateId = scheduleId + viewName + 'eventTemplate';\n            var templateArgs = util.addLocalOffsetToEvent(eventObj, this.parent.eventFields);\n            templateElement = this.parent.getAppointmentTemplate()(templateArgs, this.parent, 'eventTemplate', templateId, false);\n        }\n        else {\n            var eventLocation = (record[this.fields.location] || this.parent.eventSettings.fields.location.default || '');\n            var appointmentSubject = createElement('div', {\n                className: cls.SUBJECT_CLASS,\n                innerHTML: (eventSubject + (eventLocation ? ';&nbsp' + eventLocation : ''))\n            });\n            var appointmentStartTime = createElement('div', {\n                className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\n                innerHTML: this.parent.getTimeString(eventData[this.fields.startTime])\n            });\n            var appointmentEndTime = createElement('div', {\n                className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\n                innerHTML: this.parent.getTimeString(eventData[this.fields.endTime])\n            });\n            if (this.parent.currentView === 'Month') {\n                if (record[this.fields.isAllDay]) {\n                    templateElement = [appointmentSubject];\n                    addClass([appointmentSubject], 'e-text-center');\n                }\n                else if (eventData.count <= 1 && !eventData.isLeft && !eventData.isRight) {\n                    templateElement = [appointmentStartTime, appointmentSubject];\n                }\n                else {\n                    templateElement = [];\n                    addClass([appointmentSubject], 'e-text-center');\n                    if (!eventData.isLeft) {\n                        templateElement.push(appointmentStartTime);\n                    }\n                    templateElement.push(appointmentSubject);\n                    if (!eventData.isRight) {\n                        templateElement.push(appointmentEndTime);\n                    }\n                }\n            }\n            else {\n                var innerElement = void 0;\n                if (record[this.fields.isAllDay]) {\n                    var allDayString = createElement('div', {\n                        className: cls.APPOINTMENT_TIME, innerHTML: this.parent.localeObj.getConstant('allDay')\n                    });\n                    innerElement = [appointmentSubject, allDayString];\n                }\n                else {\n                    var timeString = this.parent.getTimeString(eventData[this.fields.startTime])\n                        + ' - ' + this.parent.getTimeString(eventData[this.fields.endTime]);\n                    var appTime = createElement('div', {\n                        className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''), innerHTML: timeString,\n                    });\n                    var appLocation = createElement('div', { className: cls.LOCATION_CLASS, innerHTML: eventLocation });\n                    innerElement = [appointmentSubject, appTime, appLocation];\n                }\n                var wrap = createElement('div', { className: 'e-inner-wrap' });\n                append(innerElement, wrap);\n                templateElement = [wrap];\n            }\n        }\n        append(templateElement, appointmentDetails);\n        this.appendEventIcons(record, appointmentDetails);\n        this.renderResizeHandler(appointmentWrapper, record.data, record[this.fields.isReadonly]);\n        return appointmentWrapper;\n    };\n    MonthEvent.prototype.appendEventIcons = function (record, appointmentDetails) {\n        var eventData = record.data;\n        if (!isNullOrUndefined(record[this.fields.recurrenceRule]) || !isNullOrUndefined(record[this.fields.recurrenceID])) {\n            var iconClass = (record[this.fields.id] === record[this.fields.recurrenceID]) ?\n                cls.EVENT_RECURRENCE_ICON_CLASS : cls.EVENT_RECURRENCE_EDIT_ICON_CLASS;\n            appointmentDetails.appendChild(createElement('div', {\n                className: cls.ICON + ' ' + iconClass + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : '')\n            }));\n        }\n        if (eventData.isLeft) {\n            var iconLeft = createElement('div', {\n                className: cls.EVENT_INDICATOR_CLASS + ' ' + cls.ICON + ' ' + cls.EVENT_ICON_LEFT_CLASS\n            });\n            prepend([iconLeft], appointmentDetails);\n        }\n        if (eventData.isRight) {\n            var iconRight = createElement('div', {\n                className: cls.EVENT_INDICATOR_CLASS + ' ' + cls.ICON + ' ' + cls.EVENT_ICON_RIGHT_CLASS\n            });\n            append([iconRight], appointmentDetails);\n        }\n    };\n    MonthEvent.prototype.renderEvents = function (event, resIndex, eventsList) {\n        var startTime = event[this.fields.startTime];\n        var endTime = event[this.fields.endTime];\n        var day = this.parent.getIndexOfDate(this.dateRender, util.resetTime(startTime));\n        if (day < 0) {\n            return;\n        }\n        if ((startTime.getTime() < this.parent.minDate.getTime()) || (endTime.getTime() > this.parent.maxDate.getTime())) {\n            return;\n        }\n        var overlapCount = this.getIndex(startTime);\n        event.Index = overlapCount;\n        var appHeight = this.eventHeight;\n        this.renderedEvents.push(extend({}, event, null, true));\n        var diffInDays = event.data.count;\n        if (startTime.getTime() <= endTime.getTime()) {\n            var appWidth = (diffInDays * this.cellWidth) - 5;\n            var cellTd = this.workCells[day];\n            var appTop = (overlapCount * (appHeight + EVENT_GAP));\n            this.renderWrapperElement(cellTd);\n            var height = this.monthHeaderHeight + ((overlapCount + 1) * (appHeight + EVENT_GAP)) + this.moreIndicatorHeight;\n            if ((this.cellHeight > height) || this.parent.rowAutoHeight) {\n                var appointmentElement = this.createAppointmentElement(event, resIndex);\n                this.applyResourceColor(appointmentElement, event, 'backgroundColor', this.groupOrder);\n                this.wireAppointmentEvents(appointmentElement, event);\n                setStyleAttribute(appointmentElement, { 'width': appWidth + 'px', 'top': appTop + 'px' });\n                this.renderEventElement(event, appointmentElement, cellTd);\n                if (this.parent.rowAutoHeight) {\n                    var firstChild = cellTd.parentElement.firstElementChild;\n                    this.updateCellHeight(firstChild, height);\n                }\n            }\n            else {\n                for (var i = 0; i < diffInDays; i++) {\n                    var cellTd_1 = this.workCells[day + i];\n                    if (cellTd_1 && isNullOrUndefined(cellTd_1.querySelector('.' + cls.MORE_INDICATOR_CLASS))) {\n                        var startDate = new Date(this.dateRender[day + i].getTime());\n                        var endDate = util.addDays(this.dateRender[day + i], 1);\n                        var groupIndex = cellTd_1.getAttribute('data-group-index');\n                        var filterEvents = this.getFilteredEvents(startDate, endDate, groupIndex);\n                        var appArea = this.cellHeight - this.monthHeaderHeight - this.moreIndicatorHeight;\n                        var renderedAppCount = Math.floor(appArea / (appHeight + EVENT_GAP));\n                        var count = (filterEvents.length - renderedAppCount) <= 0 ? 1 : (filterEvents.length - renderedAppCount);\n                        var moreIndicatorElement = this.getMoreIndicatorElement(count, startDate, endDate);\n                        if (!isNullOrUndefined(groupIndex)) {\n                            moreIndicatorElement.setAttribute('data-group-index', groupIndex);\n                        }\n                        moreIndicatorElement.style.top = appArea + 'px';\n                        moreIndicatorElement.style.width = cellTd_1.offsetWidth - 2 + 'px';\n                        this.renderElement(cellTd_1, moreIndicatorElement);\n                        EventHandler.add(moreIndicatorElement, 'click', this.moreIndicatorClick, this);\n                    }\n                }\n            }\n        }\n    };\n    MonthEvent.prototype.updateCellHeight = function (cell, height) {\n        if ((height > cell.offsetHeight)) {\n            setStyleAttribute(cell, { 'height': height + 'px' });\n        }\n    };\n    MonthEvent.prototype.updateBlockElements = function () {\n        var blockElement = [].slice.call(this.element.querySelectorAll('.' + cls.BLOCK_APPOINTMENT_CLASS));\n        for (var _i = 0, blockElement_1 = blockElement; _i < blockElement_1.length; _i++) {\n            var element = blockElement_1[_i];\n            var target = closest(element, 'tr');\n            this.monthHeaderHeight = element.offsetParent.offsetTop - target.offsetTop;\n            element.style.height = ((target.offsetHeight - 1) - this.monthHeaderHeight) + 'px';\n            var firstChild = target.firstElementChild;\n            var width = Math.round(element.offsetWidth / firstChild.offsetWidth);\n            element.style.width = (firstChild.offsetWidth * width) + 'px';\n        }\n    };\n    MonthEvent.prototype.getFilteredEvents = function (startDate, endDate, groupIndex, eventsList) {\n        var filteredEvents;\n        if (isNullOrUndefined(groupIndex)) {\n            filteredEvents = this.filterEvents(startDate, endDate);\n        }\n        else {\n            var data = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)];\n            filteredEvents = this.filterEvents(startDate, endDate, isNullOrUndefined(eventsList) ? undefined : eventsList, data);\n        }\n        return filteredEvents;\n    };\n    MonthEvent.prototype.getOverlapEvents = function (date, appointments) {\n        var appointmentsList = [];\n        for (var _i = 0, appointments_1 = appointments; _i < appointments_1.length; _i++) {\n            var app = appointments_1[_i];\n            if ((util.resetTime(app[this.fields.startTime]).getTime() <= util.resetTime(date).getTime()) &&\n                (util.resetTime(app[this.fields.endTime]).getTime() >= util.resetTime(date).getTime())) {\n                appointmentsList.push(app);\n            }\n        }\n        return appointmentsList;\n    };\n    MonthEvent.prototype.getIndex = function (date) {\n        var appIndex = -1;\n        var appointments = this.renderedEvents;\n        if (appointments.length > 0) {\n            var appointmentsList = this.getOverlapEvents(date, appointments);\n            var appLevel = appointmentsList.map(function (obj) { return obj.Index; });\n            appIndex = (appLevel.length > 0) ? this.getSmallestMissingNumber(appLevel) : 0;\n        }\n        return (appIndex === -1) ? 0 : appIndex;\n    };\n    MonthEvent.prototype.moreIndicatorClick = function (event) {\n        var _this = this;\n        var target = closest(event.target, '.' + cls.MORE_INDICATOR_CLASS);\n        var startDate = new Date(parseInt(target.getAttribute('data-start-date'), 10));\n        var endDate = new Date(parseInt(target.getAttribute('data-end-date'), 10));\n        var groupIndex = target.getAttribute('data-group-index');\n        var moreArgs = {\n            cancel: false, event: event, element: target, isPopupOpen: true,\n            startTime: startDate, endTime: endDate, viewName: this.parent.getNavigateView()\n        };\n        if (groupIndex) {\n            moreArgs.groupIndex = parseInt(groupIndex, 10);\n        }\n        this.parent.trigger(events.moreEventsClick, moreArgs, function (clickArgs) {\n            if (isBlazor()) {\n                clickArgs.startTime = new Date('' + clickArgs.startTime);\n                clickArgs.endTime = new Date('' + clickArgs.endTime);\n                clickArgs.element = getElement(clickArgs.element);\n            }\n            if (!clickArgs.cancel) {\n                if (clickArgs.isPopupOpen) {\n                    var filteredEvents = _this.getFilteredEvents(startDate, endDate, groupIndex);\n                    var moreEventArgs = { date: startDate, event: filteredEvents, element: event.target };\n                    _this.parent.quickPopup.moreEventClick(moreEventArgs, endDate, groupIndex);\n                }\n                else {\n                    _this.parent.setScheduleProperties({ selectedDate: startDate });\n                    _this.parent.changeView(clickArgs.viewName, event);\n                }\n            }\n        });\n    };\n    MonthEvent.prototype.renderEventElement = function (event, appointmentElement, cellTd) {\n        var _this = this;\n        var eventType = appointmentElement.classList.contains(cls.BLOCK_APPOINTMENT_CLASS) ? 'blockEvent' : 'event';\n        var eventObj = this.getEventData(event);\n        var args = { data: eventObj, element: appointmentElement, cancel: false, type: eventType };\n        this.parent.trigger(events.eventRendered, args, function (eventArgs) {\n            if (eventArgs.cancel) {\n                _this.renderedEvents.pop();\n            }\n            else {\n                _this.renderElement(cellTd, appointmentElement);\n            }\n        });\n    };\n    MonthEvent.prototype.getEventData = function (event) {\n        var eventObj = extend({}, event, null, true);\n        eventObj[this.fields.startTime] = event.data[this.fields.startTime];\n        eventObj[this.fields.endTime] = event.data[this.fields.endTime];\n        return eventObj;\n    };\n    MonthEvent.prototype.renderElement = function (cellTd, element) {\n        if (cellTd.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS)) {\n            cellTd.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS).appendChild(element);\n        }\n        else {\n            var wrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            wrapper.appendChild(element);\n            cellTd.appendChild(wrapper);\n        }\n    };\n    MonthEvent.prototype.renderWrapperElement = function (cellTd) {\n        var element = cellTd.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!isNullOrUndefined(element)) {\n            this.monthHeaderHeight = element.offsetTop - cellTd.offsetTop;\n        }\n        else {\n            var wrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            cellTd.appendChild(wrapper);\n            this.monthHeaderHeight = wrapper.offsetTop - cellTd.offsetTop;\n        }\n    };\n    MonthEvent.prototype.getMoreIndicatorElement = function (count, startDate, endDate) {\n        var moreIndicatorElement = createElement('div', {\n            className: cls.MORE_INDICATOR_CLASS,\n            innerHTML: '+' + count + '&nbsp;' + (this.parent.isAdaptive ? '' : this.parent.localeObj.getConstant('more')),\n            attrs: {\n                'tabindex': '0',\n                'data-start-date': startDate.getTime().toString(),\n                'data-end-date': endDate.getTime().toString(),\n                'role': 'list'\n            }\n        });\n        return moreIndicatorElement;\n    };\n    MonthEvent.prototype.removeHeightProperty = function (selector) {\n        var rows = [].slice.call(this.element.querySelectorAll('.' + selector + ' tbody tr'));\n        for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n            var row = rows_1[_i];\n            row.firstElementChild.style.height = '';\n        }\n    };\n    return MonthEvent;\n}(EventBase));\nexport { MonthEvent };\n"]},"metadata":{},"sourceType":"module"}