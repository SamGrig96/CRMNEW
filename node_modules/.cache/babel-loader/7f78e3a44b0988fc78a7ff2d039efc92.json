{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\grigo\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\CRM\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{connect}from\"react-redux\";import{Redirect,withRouter}from\"react-router-dom\";import{bindActionCreators,compose}from\"redux\";import{getEmailMessage,modifyMessages}from\"../actions/message-list.actions\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faSpinner}from\"@fortawesome/free-solid-svg-icons\";import MessageToolbar from\"../message-toolbar/MessageToolbar\";import\"./messageContent.scss\";export var MessageContent=/*#__PURE__*/function(_Component){_inherits(MessageContent,_Component);var _super=_createSuper(MessageContent);function MessageContent(props){var _this;_classCallCheck(this,MessageContent);_this=_super.call(this,props);_this.state={errorMessage:undefined};_this.iframeRef=React.createRef();_this.modifyMessage=_this.modifyMessage.bind(_assertThisInitialized(_this));return _this;}_createClass(MessageContent,[{key:\"componentDidMount\",value:function componentDidMount(prevProps){var messageId=this.props.match.params.id;console.log(this.props.match.path,\"message\");this.props.getEmailMessage(messageId);}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){console.log(this.props,\"props\");var emailMessageResult=this.props.emailMessageResult;console.log(emailMessageResult,'emailMessageResult ');if(!emailMessageResult.loading){if(!emailMessageResult.failed){if(this.iframeRef.current){var body=this.iframeRef.current.contentWindow.document.body;body.style.margin=\"0px\";body.style.fontFamily=\"Arial, Helvetica, sans-serif\";body.style.fontSize=\"13px\";body.innerHTML=this.props.emailMessageResult.body;}}else{if(!this.state.errorMessage){this.setState({// errorMessage: emailMessageResult.error.result.error.message,\nmodal:true});}}}}},{key:\"renderSpinner\",value:function renderSpinner(){return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex h-100 justify-content-center align-items-center  \"},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faSpinner,spin:true,size:\"5x\"}));}},{key:\"renderErrorModal\",value:function renderErrorModal(){return/*#__PURE__*/React.createElement(Redirect,{to:\"/notfound\"});}},{key:\"modifyMessage\",value:function modifyMessage(addLabelIds,removeLabelIds){var id=this.props.emailMessageResult.result.id;var actionParams=_objectSpread(_objectSpread({},addLabelIds&&{addLabelIds:addLabelIds}),removeLabelIds&&{removeLabelIds:removeLabelIds});this.props.modifyMessages(_objectSpread({ids:[id]},actionParams));this.props.history.goBack();}},{key:\"render\",value:function render(){if(this.props.emailMessageResult.loading){return this.renderSpinner();}return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-center align-items-center message-content\"},this.props.emailMessageResult.loading?this.renderSpinner():null,this.state.errorMessage?this.renderErrorModal():/*#__PURE__*/React.createElement(\"iframe\",{ref:this.iframeRef,title:\"Message contents\",id:\"message-iframe\",style:{display:this.props.emailMessageResult.loading?\"none\":\"block\"}}));}}]);return MessageContent;}(Component);var mapStateToProps=function mapStateToProps(state){return{emailMessageResult:state.emailMessageResult};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({getEmailMessage:getEmailMessage,modifyMessages:modifyMessages},dispatch);};export default compose(withRouter,connect(mapStateToProps,mapDispatchToProps))(MessageContent);","map":{"version":3,"sources":["C:/Users/grigo/OneDrive/Рабочий стол/CRM/src/components/content/message-list/message-content/MessageContent.jsx"],"names":["React","Component","connect","Redirect","withRouter","bindActionCreators","compose","getEmailMessage","modifyMessages","FontAwesomeIcon","faSpinner","MessageToolbar","MessageContent","props","state","errorMessage","undefined","iframeRef","createRef","modifyMessage","bind","prevProps","messageId","match","params","id","console","log","path","emailMessageResult","loading","failed","current","body","contentWindow","document","style","margin","fontFamily","fontSize","innerHTML","setState","modal","addLabelIds","removeLabelIds","result","actionParams","ids","history","goBack","renderSpinner","renderErrorModal","display","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Redirect, withRouter } from \"react-router-dom\";\r\nimport { bindActionCreators, compose } from \"redux\";\r\nimport {\r\n  getEmailMessage,\r\n  modifyMessages\r\n} from \"../actions/message-list.actions\";\r\n\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faSpinner } from \"@fortawesome/free-solid-svg-icons\";\r\n\r\n\r\nimport MessageToolbar from \"../message-toolbar/MessageToolbar\";\r\n\r\nimport \"./messageContent.scss\";\r\n\r\nexport class MessageContent extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      errorMessage: undefined\r\n    \r\n    };\r\n\r\n    this.iframeRef = React.createRef();\r\n    this.modifyMessage = this.modifyMessage.bind(this);\r\n  }\r\n\r\n  componentDidMount(prevProps) {\r\n    \r\n    const messageId = this.props.match.params.id;\r\n    console.log(this.props.match.path,\"message\")\r\n    this.props.getEmailMessage(messageId);\r\n    \r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    console.log(this.props,\"props\")\r\n    const { emailMessageResult } = this.props;\r\n    console.log(emailMessageResult ,'emailMessageResult ');\r\n    \r\n    if (!emailMessageResult.loading) {\r\n      if (!emailMessageResult.failed) {\r\n        if (this.iframeRef.current) {\r\n          const { body } = this.iframeRef.current.contentWindow.document;\r\n          body.style.margin = \"0px\";\r\n          body.style.fontFamily = \"Arial, Helvetica, sans-serif\";\r\n          body.style.fontSize = \"13px\";\r\n          body.innerHTML = this.props.emailMessageResult.body;\r\n        }\r\n      } else {\r\n        if (!this.state.errorMessage) {\r\n          this.setState({\r\n            // errorMessage: emailMessageResult.error.result.error.message,\r\n            modal: true\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  renderSpinner() {\r\n    return (\r\n      <div className=\"d-flex h-100 justify-content-center align-items-center  \">\r\n        <FontAwesomeIcon icon={faSpinner} spin size=\"5x\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderErrorModal() {\r\n    return <Redirect to=\"/notfound\" />;\r\n  }\r\n\r\n  modifyMessage(addLabelIds, removeLabelIds) {\r\n    const id = this.props.emailMessageResult.result.id;\r\n    \r\n    const actionParams = {\r\n      ...(addLabelIds && { addLabelIds }),\r\n      ...(removeLabelIds && { removeLabelIds })\r\n    };\r\n    this.props.modifyMessages({ ids: [id], ...actionParams });\r\n    this.props.history.goBack();\r\n  }\r\n\r\n  render() {\r\n    if (this.props.emailMessageResult.loading) {\r\n      return this.renderSpinner();\r\n    }\r\n\r\n    return (\r\n     \r\n     \r\n        <div className=\"d-flex justify-content-center align-items-center message-content\">\r\n          {this.props.emailMessageResult.loading ? this.renderSpinner() : null}\r\n          {this.state.errorMessage ? (\r\n            this.renderErrorModal()\r\n          ) : (\r\n            <iframe\r\n              ref={this.iframeRef}\r\n              title=\"Message contents\"\r\n              id=\"message-iframe\"\r\n              style={{\r\n                display: this.props.emailMessageResult.loading\r\n                  ? \"none\"\r\n                  : \"block\"\r\n              }}\r\n            />\r\n          )}\r\n        </div>\r\n      \r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  emailMessageResult: state.emailMessageResult\r\n});\r\n\r\nconst mapDispatchToProps = dispatch =>\r\n  bindActionCreators(\r\n    {\r\n      getEmailMessage,\r\n      modifyMessages\r\n    },\r\n    dispatch\r\n  );\r\n\r\nexport default compose(\r\n  withRouter,\r\n  connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n  )\r\n)(MessageContent);\r\n"]},"metadata":{},"sourceType":"module"}